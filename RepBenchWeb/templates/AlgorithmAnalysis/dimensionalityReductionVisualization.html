{% extends "displayDataSetSynthetic.html" %}
{% load static %}

    <div class="kt-portlet">
        <div class="kt-portlet__head">
            <div class="kt-portlet__head-label">
                <h3 class="kt-portlet__head-title">  Select an Algorithm </h3>
            </div>
            <div class="kt-portlet__head-toolbar">
            </div>
        </div>
        <div class="kt-portlet__body" >
        </div>

    </div>
{% block aboveChartContent %}
      <div class="kt-portlet kt-portlet__body--fill">
        <div class="kt-portlet__head">
            <div class="kt-portlet__head-label">
                <h3 class="kt-portlet__head-title"> Select an Algorithm </h3>
            </div>
            <div class="kt-portlet__head-toolbar">
            </div>
        </div>
        <div class="kt-portlet__body" style="text-align:center;">
            <div class="row alg-selection" style="display: flex; justify-content: center; align-items: center;">
                <div class="form-group" id="alg-selection">
                    <label>Algorithm
                        {#                        <a tabindex="10" class="btn" role="button" data-toggle="kt-popover"#}
                        {#                                       data-placement="top"#}
                        {#                                       data-trigger="focus"#}
                        {#                                       data-content="Select the algorithm you want to use for repair"#}
                        {#                                       data-original-title="" title=""><i#}
                        {#                            class="mdi mdi-information-outline mdi-18px"></i></a>#}
                    </label>
                    <select class="form-control" name="algorithm" onchange="displayfunc(value)">
                        {% for key, _ in alg_forms.items %}
                            <option value={{ key }}> {{ key }}</option>
                        {% endfor %}
                    </select>
                </div>
                {% for key, form in alg_forms.items %}
                    {% include 'sub/form.html' with form=form form_id=key style="display:none;" button_label="RUN!" onclick="repair('"|add:key|add:"')" %}
                {% endfor %}

            </div>
        </div>

    </div>
{% endblock %}

{% block belowChartContent %}

    <style>
        .form-group {
            display: inline-block;
        }
    </style>

    {#    <div class="col-md-12">#}

    {#    </div>#}


    {#    </div>#}

    <div class="kt-portlet">
        <div class="kt-portlet__head">
            <div class="kt-portlet__head-label">
                <h3 class="kt-portlet__head-title"><h2>Reduced Series update with IRLS Algorithm</h2>
                </h3>
            </div>
            <div class="kt-portlet__head-toolbar">
            </div>
        </div>
        <div class="kt-portlet__body">
            Difference of series is dependent on the K and delta. Larger values of K result into better
            distinguishable series.
            <div id="classificationReductionChartContainer"></div>

        </div>

    </div>



{#    <div class="viz-chart-info">#}
{#        <h2>Reduced Series update with IRLS Algorithm</h2>#}
{#        Difference of series is dependent on the K and delta. Larger values of K result into better#}
{#        distinguishable series.#}
{#    </div>#}
{#    <div id="classificationReductionChartContainer"></div>#}

    <div class="kt-portlet">
    <div class="kt-portlet__head">
        <div class="kt-portlet__head-label">
            <h3 class="kt-portlet__head-title"><h2>Detection of Anomalies</h2></h3>
        </div>
        <div class="kt-portlet__head-toolbar">
        </div>
    </div>
    <div class="kt-portlet__body">
          Normalized absolute differences between the reduced series and the anomalous series to classify the
        anomalies.
            <div id="thresholdChartContainer"></div>

    </div>

</div>

{##}
{#    <div class="viz-chart-info">#}
{#        <h2>Detection of Anomalies</h2>#}
{#        Normalized absolute differences between the reduced series and the anomalous series to classify the#}
{#        anomalies.#}
{#    </div>#}
{#    <div id="thresholdChartContainer"></div>#}

    <div class="kt-portlet">
    <div class="kt-portlet__head">
        <div class="kt-portlet__head-label">
            <h3 class="kt-portlet__head-title"> <h2> Repair of Timeseries </h2></h3>
        </div>
        <div class="kt-portlet__head-toolbar">
        </div>
    </div>
    <div class="kt-portlet__body" >
        Replacing the values above the threshold with the values of the iteratively reduced series. First the
        values classified as anomalies are linearly interpolated. Then the values are replaced with the
        iteratively reduced series.
    </div>
        <div id="RepairIterChartContainer"></div>

</div>


{#    <div class="viz-chart-info">#}
{#        <h2>Repair of Timeseries</h2>#}
{#        Replacing the values above the threshold with the values of the iteratively reduced series. First the#}
{#        values classified as anomalies are linearly interpolated. Then the values are replaced with the#}
{#        iteratively reduced series.#}
{#    </div>#}
{##}
{##}
{#    <div id="menu" class="col-md-3">#}
{#    </div>#}


    <script type="text/javascript">
        let lastkey = null
        let displayfunc = function (key) {
            var x = document.getElementById(key);
            if (key !== lastkey && lastkey != null) {
                document.getElementById(lastkey).style.display = "none";
            }
            if (x.style.display === "none") {
                x.style.display = "block";

                // get the button inside the element
                var button = x.getElementsByTagName("button")[0];

                x.style["margin-left"] = "10px";
                x.style["transform"] = "translate(0, 1.2px)";
                button.style["transform"] = "translate(0, -4.5px)";
            } else {
                x.style.display = "none";
            }
            lastkey = key
        }
        displayfunc("RPCA")

        const dataTitle = '{{ data_info.title }}'
        {#const injection_url = "{% url 'inject_data' setname=setname %}"#}
        const repair_url = "{% url 'alg_inspection_repair' setname=setname %}"
        {#const store_url = "{% url 'store_data' setname=setname %}"#}
    </script>
    <script src="{% static 'js/repBench/AlgorithmAnalysis/dimensionality_reduction_viz.js' %}"
            type="text/javascript"></script>
    <script src="{% static 'js/repBench/AlgorithmAnalysis/ReductionVizChart.js' %}" type="text/javascript"></script>

    {#          {% include 'sub/score-board.html' %}#}

{% endblock %}

{##}
{#{% block additional_bottom_js %}#}
{##}
{#    <script src="{% static 'js/custom/form.extensions.js' %}" type="text/javascript"></script>#}
{#    <script src="{% static 'js/page/detection/nouislider-init.js' %}" type="text/javascript"></script>#}
{#    <script src="{% static 'js/page/detection/page.init.js' %}" type="text/javascript"></script>#}
{#    <script src="{% static 'js/page/detection/form.init.js' %}" type="text/javascript"></script>#}
{##}
{#    <script type="text/javascript">#}
{#        let injection_url = "{% url 'inject_data' setname=setname %}"#}
{#        let repair_url = "{% url 'alg_inspection_repair' setname=setname %}"#}
{#    </script>#}
{#    <script src="{% static 'js/injection.js' %}" type="text/javascript"></script>#}
{#    <script src="{% static 'js/dimensionality_reduction_viz.js' %}" type="text/javascript"></script>#}
{##}
{#{% endblock %}#}
