{% extends "displayDataSetSynthetic.html" %}
{% load static %}


{% block content %}
    <div class="row">
        <div class="col-md-9">
            {% include 'sub/flaml-example.html' %}
        </div>
        <div id="rec_info" class="col-md-3">
            <div class="kt-portlet">
                <div class="kt-portlet__head">
                    <div class="kt-portlet__head-label">
                        <h3 class="kt-portlet__head-title"> Repair Recommendation </h3>
                    </div>
                    <div class="kt-portlet__head-toolbar">
                    </div>
                </div>
                <div class="kt-portlet__body">
                    <table style="border-spacing: 10px;">
                        <tr>
                            <td style="text-align:left; padding-right: 10px;">Recommend Algorithm</td>
                            <td style="text-align:left;" id="recommended_algorithm"></td>
                        </tr>
                        <tr>
                            <td style="text-align:left; padding-right: 10px;">Used Classifier</td>
                            <td style="text-align:left;" id="used_classifier"></td>
                        </tr>
                    </table>
                    <p> Algorithm classification using <a href="https://microsoft.github.io/FLAML/">FLAML autoML</a>
                        to
                        recommend the
                        most
                        suitable anomaly repair algorithm. </p>
                    <p> Features from catch22, tsfresh and correlation values between the time series are used to
                        train
                        the
                        classifiers.
                    </p>
                    <p> The classifier options are lgbm, rf, xgboost, extra_tree, xgb_limitdepth and lrl1.
                    </p>
                    {#                <h2>Dataset: {{ data_info.title }}</h2>#}
                </div>
            </div>
        </div>

        <div id="main-chart" class="col-md-12">
            <div class="kt-portlet">
                <div class="kt-portlet__head">
                    <div class="kt-portlet__head-label">
                        <h3 class="kt-portlet__head-title"> {{ setname }} </h3>
                    </div>
                    <div class="kt-portlet__head-toolbar">
                        <div id="highcharts_head_actions" class="kt-portlet__head-actions">
                            {#                        <a id="reset_chart_btn" class="btn btn-outline-brand btn-bold btn-sm"#}
                            {#                           onclick="chartManager.clearAllSeries();return false;">Reset</a>#}
                            <div class="dropdown dropdown-inline">
                                <a href="#" class="btn btn-outline-brand btn-icon btn-sm" data-toggle="dropdown"
                                   aria-haspopup="true" aria-expanded="false">
                                    <i class="mdi mdi-18px mdi-dots-horizontal"></i>
                                </a>

                                <div class="dropdown-menu dropdown-menu-right">
                                    <ul class="kt-nav">
                                        <li class="kt-nav__section kt-nav__section--first">
                                            <span class="kt-nav__section-text">Load Data</span>
                                        </li>
                                        <li class="kt-nav__item">
                                            <a id="raw_btn" onclick="chartManager.setOriginal(); return false;"
                                               class="kt-nav__link">
                                                <span class="kt-nav__link-text">Raw</span>
                                            </a>
                                        </li>
                                        <li class="kt-nav__item">
                                            <a id="zscore_btn" onclick="chartManager.setZscore(); return false;"
                                               class="kt-nav__link">
                                                <span class="kt-nav__link-text">Normalized</span>
                                            </a>
                                        </li>
                                        {#                                        <li class="kt-nav__section kt-nav__section--first">#}
                                        {#                                            <span class="kt-nav__section-text">Download</span>#}
                                        {#                                        </li>#}
                                        {#                                        <li class="kt-nav__item">#}
                                        {#                                            <a id="download_csv" href="#" class="kt-nav__link">#}
                                        {#                                                <span class="kt-nav__link-text">Download CSV</span>#}
                                        {#                                            </a>#}
                                        {#                                        </li>#}
                                        {#                                        <li class="kt-nav__item">#}
                                        {#                                            <a id="download_json" href="#" class="kt-nav__link">#}
                                        {#                                                <span class="kt-nav__link-text">Download JSON</span>#}
                                        {#                                            </a>#}
                                        {#                                        </li>#}
                                    </ul>
                                </div>
                            </div>
                            <div class="dropdown dropdown-inline">
                                <a class="btn btn-outline-brand btn-icon btn-sm" onclick="toggleChart()">
                                    <i id="chart-resize-id" class="mdi mdi-18px mdi-plus"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="kt-portlet__body kt-portlet__body--fit">
                </div>
                <!--begin: Highcharts -->
                {% include 'sub/MainChart.html' with chartHeight=400 %}
                <!--end: Highcharts -->
            </div>
        </div>

        <div class="col-md-4">
            <div class="kt-portlet">
                <div class="kt-portlet__head">
                    <div class="kt-portlet__head-label">
                        <h3 class="kt-portlet__head-title"> Classification Probabilities </h3>
                    </div>
                    <div class="kt-portlet__head-toolbar">
                    </div>
                </div>
                <div class="kt-portlet__body">

                    <div id="probabilities-chart" class="mybox-content"></div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="kt-portlet">
                <div class="kt-portlet__head">
                    <div class="kt-portlet__head-label">
                        <h3 class="kt-portlet__head-title"> Scores for each Algorithm</h3>
                    </div>
                    <div class="kt-portlet__head-toolbar">
                    </div>
                </div>
                <div class="kt-portlet__body">

                    <div id="alg-scores-chart" class="mybox-content"></div>
                </div>
            </div>
        </div>


    </div>
{% endblock %}


{% block additional_bottom_js %}
    {#    <script type="text/javascript">#}
    {#        let recommendation_url = "{% url 'get_recommendation' setname=setname %}"#}
    {#    </script>#}
    {#    <script src="{% static 'js/repair.js' %}" type="text/javascript"></script>#}
    <script src="{% static 'js/repBench/recommendation/recommendation_charts.js' %}" type="text/javascript"></script>
    {#    <script src="{% static 'js/repBench/recommendation/recommendation.js' %}" type="text/javascript"></script>#}
    <script>
        function toggleChart() {
            var icon = document.getElementById('chart-resize-id');
            var chart = document.getElementById('main-chart');
            if (chart.classList.contains('col-md-12')) {
                icon.classList.remove('mdi-minus');
                icon.classList.add('mdi-plus');
                chart.classList.remove('col-md-12');
                chart.classList.add('col-md-4');
            } else {
                icon.classList.remove('mdi-plus');
                icon.classList.add('mdi-minus');
                chart.classList.remove('col-md-4');
                chart.classList.add('col-md-12');
            }
        }
    </script>
{% endblock %}