<div class="kt-portlet__body">
    <div class="form-group">
        <label>Algorithm<a tabindex="10" class="btn" role="button" data-toggle="kt-popover" data-placement="top"
                           data-trigger="focus"
                           data-content="Select the algorithm you want to use for repair"
                           data-original-title="" title=""><i
                class="mdi mdi-information-outline mdi-18px"></i></a></label>
        <select id="alg-select" class="form-control" name="algorithm" onchange="displayfunc(value)">
            {#            <option value="" selected="">----</option>#}
            {% for key, _ in alg_forms.items %}
                <option value={{ key }}>{{ key }}</option>
            {% endfor %}
        </select>
        {% for key, form in alg_forms.items %}
            {% include 'parts/form.html' with form=form form_id=key style="display:none;" onclick="repair('"|add:key|add:"')" button_label="Repair" button_id="repair-button" class="disabled repair_button" %}

        {% endfor %}

    </div>
</div>

<script>

    let lastkey = null
    let displayfunc = function (key) {
        console.log(key)
        var x = document.getElementById(key);
        if (key !== lastkey && lastkey != null) {
            document.getElementById(lastkey).style.display = "none";
        }
        if (x.style.display === "none") {
            x.style.display = "block"
        } else {
            x.style.display = "none";
        }
        lastkey = key
    }
    // select second option from alg-select
    var selectElement = document.getElementById('alg-select');
    selectElement.selectedIndex = 1;
    displayfunc(selectElement.value)


    // endable repair buttons with class disabled if injection is triggered
    inject_button = document.getElementById('injection-button')
    inject_button.addEventListener('click', function () {
        Array.from(document.getElementsByClassName('repair_button')).forEach(b => b.classList.remove('disabled'))
    })

    resetButton = document.getElementById('reset_chart_btn')
    resetButton.addEventListener('click', function () {
        Array.from(document.getElementsByClassName('repair_button')).forEach(b => b.classList.add('disabled'))
    })

</script>

